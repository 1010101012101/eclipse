<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.5 [en] (Win98; I) [Netscape]">
   <meta name="Author" content="Andrew Eidsness and Pascal Rapicault">
   <title>Branding your application [DRAFT]</title>
  <link rel="stylesheet" href="default_style.css">
</head>
<body>
                                                                        
<body LINK="#0000ff" VLINK="#800080" background="proposal.gif">

<div align="right"><font face="Times New Roman, Times, serif" size="2">Copyright 
  &copy; 2004 International Business Machines Corporation. All rights reserved</font> 
  <table border=0 cellspacing=0 cellpadding=2 width="100%">
    <tr> 
      <td align=LEFT valign=TOP colspan="2" bgcolor="#0080C0"><b><font face="Arial,Helvetica"><font color="#FFFFFF">Eclipse 
        Corner Article</font></font></b></td>
    </tr>
  </table>
</div>
<div align="left"> 
  <h1><img src="idea.jpg" height=86 width=120 align=CENTER></h1>
</div>

<center>
<h1>
Branding your application [DRAFT]</h1></center>

<blockquote><b>Summary</b> <br>
  In this article we look at the steps needed to create branding for your product. Before 
    we get too excited hoping the magic of product building will be revealed, 
    we should first confess that we will focus only on those aspects of the platform 
    which you will need to modify in order to control the look of your product. 
    This will include such items as the splash screen, about dialog, the program 
    executable and so forth.
  <p><b>By Andrew Eidsness and Pascal Rapicault, IBM OTI Lab</b> <br>
    <font size=-1>July 6, 2004</font> 
</blockquote>
<hr WIDTH="100%">

<h2>The high level picture</h2>
<p>You have written all the code and now it is time to bundle up your code with 
  the platform and change the identity to have your product brand. Before diving 
  into the details of each step let's take a sneak peak at the big picture and 
  get a flavor for the kinds of things we'll be doing. The high level steps are 
  as follows:</p>
<ol>
  <li>Create a product extension</li>
  <li>Replace the splash screen</li>
  <li>Make your product active</li>
  <li>Create graphics for the executable</li>
  <li>Create a new executable</li>
</ol>
<p>As you work through the steps you may notice the occasional <b><img src="TryIt.gif" width="61" height="13"></b>. 
  These indicate points at which you may want to test out the work you have done 
  thus far. All along this document the examples will brand the RCP Browser example.
</p>
<p>The steps in this document assume that you have access to the SDK build but it is important to 
note that all the things that we will be working with can be applied to any RCP based application. 
In the remaining sections we assume that you have a working knowledge of plug-ins.</p>
<p>Before continuing make sure that you have installed the <a href="http://www.eclipse.org/downloads/index.php">RCP Runtime Binary</a>.  You should not consider branding/productization unless you are also including your own plug-ins.  
In this article we use the RCP Browser Example as the plug-in to which branding is applied. It is available 
from the <a href="http://dev.eclipse.org/viewcvs/index.cgi/org.eclipse.ui.examples.rcp.browser/">eclipse repository</a>.
</p>

<p>This article is intended to be a guide to help you produce a release. You need 
  to ensure that you comply with any terms and conditions of the license under 
  which you received the platform runtime.</p>

<h3>Download the Eclipse RCP Runtime Binary</h3>
<p><b><img src="TryIt.gif" width="61" height="13"></b> Navigate to a mirror from the <a href="http://www.eclipse.org/downloads/index.php">Eclipse Download site</a> and find the page for the 3.0 release of Eclipse.  Find the section on that page for the <b>RCP Runtime Binary</b> and download the distribution applicable to your platform.  Extract the package to some directory on your machine but don't try to start it yet.  This will be the target platform you use for the rest of the examples in this article.</p>
<p>You will also need the <code>org.eclipse.ui.examples.rcp.browser</code> project from CVS.  We'll assume you are comfortable working with Eclipse and are able to checkout and build this project -- afterall, you've already developed the plugins that compose your product!</p>
<p>&nbsp;</p>

<h2>Create a product extension</h2>
<p>Eclipse applications contribute branding by extending the <code>org.eclipse.core.runtime.products</code> extension point.  Many plugins may extend this point but only one such extension is active when eclipse is running.</p>
<p>This extension point supplies the following elements:
<ul>
<li>The application name</li>
<li>The image that the window system associates with the product</li>
<li>Content of the about dialog</li>
<li>Special preference settings used by the product</li>
</ul>
<p>The string values are generally supplied using variables that are defined in the corresponding plugin.properties file (to allow for internationalization, etc.) but for simplicity this article will just show only the actual string.</p>
<p>For reference here is the complete definition of our example extension, each component is described in the following subsections.</p>
<blockquote>
  <pre>&lt;extension
      point=&quot;org.eclipse.core.runtime.products&quot;
      id=&quot;product&quot;&gt;
   &lt;product
         name=&quot;RCP Browser Example&quot;
         application=&quot;org.eclipse.ui.examples.rcp.browser.app&quot;&gt;
      &lt;property
            name=&quot;appName&quot;
            value=&quot;Browser Example&quot;/&gt;
      &lt;property
            name=&quot;windowImages&quot;
            value=&quot;icons/alt16.gif,icons/alt32.gif&quot;/&gt;
      &lt;property
            name=&quot;aboutImage&quot;
            value=&quot;icons/alt_about.gif&quot;/&gt;
      &lt;property
            name=&quot;aboutText&quot;
            value=&quot;The about dialog text can contain links such as http://www.eclipse.org.&quot;/&gt;
   &lt;/product&gt;
&lt;/extension&gt;
  </pre>
</blockquote>

<h3><b>The product element</b></h3>
The product element supplies all of the branding information.  The value of the name attribute appears in the title bar of the running browser while the application attribute specifies the id of the default application to be used with this unit of branding.  The default application can be overridden as described later in this article.</p>
<p>The rest of the product element consists of properties, each of which control a single aspect of the product's brand.  The properties are treated as opaque strings by the runtime.  Plugins can retrieve the value of these properties using the <code>org.eclipse.core.runtime.IProduct#getProperty</code> method.  The properties used by the UI (for branding) are listed in <code>org.eclipse.ui.branding.IProductConstants</code>.  The following sub-sections describe each of these.</p>

<h3><b>The image the window system associates with the product</b></h3>
<p>SWT allows a set of images to be associated with a shell.  The expectation is that all images in the set will have the same appearance but be rendered at different sizes.  These images are provided to the SWT shell which is then able to select the most appropriate one for each specific use.  For example, on Windows® the smaller image (16x16) will be used for the title and task bars while the larger image (32x32) will appear in the Alt-Tab application switcher.</p>
<p>The comma-separated list that is set in the <i>windowImages</i> property should have at least one image.</p>

<h3><b>Changing the content of the about dialog</b></h3>
<p>Both the image and the text in the main about dialog are subject to product level branding.  The value of the <i>aboutImage</i> property should point to an image that is no larger than 500x330 pixels.  The value of the <i>aboutText</i> property will only be shown if the about image is no larger than 250x330 pixels.</p>
<h3><b>Special preferences settings used by the product</b></h3>
<p>Although not shown in this example it is also possible to specify a set of preferences that should be used with the product.  For example, the preference settings might be used to specify an alternate presentation factory.  The preferences should be stored in a file which is pointed to by the <i>preferenceCustomization</i> property.  See <a href="http://dev.eclipse.org/viewcvs/index.cgi/~checkout~/platform-ui-home/rcp/index.html#rcp_and_r21">Eclipse Rich Client Platform</a> for an example.</p>

<h3>Testing the branding while selfhosting</h3>
<p><b><img src="TryIt.gif" width="61" height="13"> </b>Ensure that the <code>plugin.xml</code> in the <code>org.eclipse.ui.examples.rcp.browser</code> project includes the product extension shown above.  Create a new runtime-workbench launch configuration, and choose the "Run a product" option and select <code>org.eclipse.ui.examples.rcp.browser.product</code> from the dropdown.<p>
<p>By default the launch configuration loads all workspace and enabled external plugins which may cause problems when running your application since several unneeded contributions will be included (e.g., menus, key bindings, etc.).  Create a minimal set of plugins by choosing the "Plug-ins" tab and selecting "Choose plug-ins and fragments to launch from the list".  Click on "Deselect All" and then choose the <code>org.eclipse.ui.examples.rcp.browser</code> plug-in.  Finally click on "Add Required Plug-ins" to compute the set of plugins actually required for your application.</p>
<p>The images referenced in this example are already available in the <code>icons/</code> directory so you are now ready to click on "Run" to launch your application.  Look for the new window icon and title as well as changes in the main about dialog.</p>

<p>&nbsp;</p>
<h2>The <code>.eclipseproduct</code> marker file</h2>
<p>The branding of the application would not be complete without updating <code>eclipse/.eclipseproduct</code>. This marker file is a <code>java.io.Properties</code> format file that indicates the name, id, and version of the product. It also controls things like the default configuration area inside the user home folder, which ensure a separation of the configuration information among products.</p>
<p>Ensure the file exists and contains:</p>
<pre>
	name=RCP Browser Example
	id=org.eclipse.ui.examples.rcp.browser.product
	version=3.0.0
</pre>

<p>&nbsp;</p>
<h2>Replacing the splash screen</h2>
<p>The splash screen (shown while the program starts) is contained in one file
usually found in the plug-in declaring the product. It must be called <b>splash.bmp</b> and must 
be a .BMP file. There are no constraints regarding the size but for reference the standard eclipse splash screen image is 500x330 pixels.</p>
<p>The splash screen to be displayed is controlled by system properties that can either be passed 
as vm arguments or added to the config.ini file that we modified previously.
The two properties are:
<ul>
	<li><b>osgi.splashLocation</b>: full path to the splash screen in the file system.  For example <code>c:/eclipse/plugins/org.eclipse.ui.examples.rcp.browser/splash.bmp</code>;</li>
	
	<li><b>osgi.splashPath</b>: comma separated list of URL that will be searched for the splash screen. Only "file:" and "platform:" URLs are supported. For example <code>platform:/base/plugins/org.eclipse.ui.examples.rcp.browser/</code>.  The entries will be searched until a file called splash.bmp is found.</li>
</ul>
<code>osgi.splashPath</code> should be preferred over <code>osgi.splashLocation</code> since 
it does not use a full path and is therefore more portable. When using platform: URLs note that the plug-in referenced must be in the plugins folder that is a sibling of the startup.jar.</p>
<p>To use NL'ed splash screens the <code>osgi.splashPath</code> property should be used and the locale specific images should be placed in a <code>nl</code> directory within the plugin's directory.  For example, a splash screen for the <code>fr_FR</code> locale would be placed within the plugin's directory as <code>nl/fr/FR</code>:
<pre>
  org.eclipse.ui.examples.rcp.browser/
    nl/
      fr/
        FR/
          splash.bmp
</pre></p>

<h2>Make your product active</h2>
<p>When shipping your application, the easiest way to select your branding is to edit the config.ini 
file which is stored in the configuration area.  The <code>eclipse.product</code> property should be set to the extension id for your product.  For the browser example the file should contain:</p>
<blockquote> 
  <pre>eclipse.product = org.eclipse.ui.examples.rcp.browser.product
  </pre>
</blockquote>
<p>It is also possible to specify your product on the command line by using the -product command line argument.  This option is useful in testing environments where you are trying to test many products, but the config.ini file is the most practical technique for a shipping RCP application.</p>

<h3>Running a standalone application</h3>
<p><img src="TryIt.gif" width="61" height="13"> The <code>org.eclipse.ui.examples.rcp.browser</code> project has config_*.ini files specific to several platforms.  Locate the one for your platform and copy the contents to <code>eclipse/configuration/config.ini</code>.</p>
<p>Within the new config.ini check that the following properties are set:
<pre>
     <code>osgi.splashPath = platform:/base/plugins/org.eclipse.ui.examples.rcp.browser</code>
     <code>eclipse.product = org.eclipse.ui.examples.rcp.browser.product</code>
</pre>

<p>Export the plugin to your RCP Binary installation and run the executable in the <code>eclipse/</code> directory.  During startup you should see an alternate splash screen as well as the branding changes you observered in the previous self-hosted workbench.  The icon shown during launch will not be changed yet, read on...</p>
<p>&nbsp;</p>

<h2>Creating the graphics for our executable</h2>
<p>The executable is located in the <code>eclipse/</code> root directory and the process 
  for replacing it is platform specific. Start by extracting the file 
  <code>eclipse/plugins/org.eclipse.platform.source_3.0.0/src/org.eclipse.platform_3.0.0/launchersrc.zip</code>
  found in the SDK.  In the following sections, we will work with the <code>library/</code> directory 
  and once we are finished we will copy the resulting executable back to the Browser
  application.</p>
<p><b><img src="win_only.gif" width="51" height="13"> </b>Windows executable 
  programs can have an associated icon(s). To create our icon we first need to 
  replace several .BMP graphics located in the <code>library</code> directory. These 
  graphics represent 16x16, 32x32 and 48x48 pixel versions of both low color and 
  high color graphics. In the <code>library/</code> directory replace the following 
  files:</p>
<ul>
  <li>icon16_basic.bmp</li>
  <li>icon16_full.bmp</li>
  <li>icon32_basic.bmp</li>
  <li>icon32_full.bmp</li>
  <li>icon48_basic.bmp</li>
  <li>icon48_full.bmp</li>
</ul>
<p>Using an appropriate graphics tool (e.g. ICONPRO provided in the MSDN) of your 
  choice, combine these graphics into a single .ICO (icon) file called <code>eclipse.ico</code> 
  and replace <code>library/win32/eclipse.ico</code> with your new eclipse.ico file. The <code>eclipse.ico</code> 
  is referenced by the file <code>library/win32/eclipse.rc</code> which is automatically used 
  when the executable build script is run. Once the build script has finished 
  we will have a new program executable with an associated icon.</p>
<p><img src="linux_only.gif" width="51" height="13"> Linux does not directly associate 
  an icon with an executable program however we can include an icon that users 
  can use when associating a shortcut with the program.  Use your favourite graphics editor to create an xpm graphic representing your program icon and place it into <code>library/icon.xpm</code>. Once we have built the executable 
  we will copy both the executable and the <code>.xpm</code> file to the <code>eclipse/</code> 
  root directory of the platform runtime build.</p>
<p>&nbsp;</p>

<h2>Creating a new executable program</h2>
<p>Executable icon in hand, it's time to make the executable. We will continue 
  to work with the <code>library/</code> directory and once we have created our executable 
  we will copy it to the <code>eclipse/</code> root directory of the runtime platform 
  build. The process for creating the program executable is different and a build
  script is provided in each subfolder to help make the process easier.</p>
<h3><b>Preparing the build script</b></h3>
<p><img src="win_only.gif" width="51" height="13"> In the <code>library/win32</code> directory 
  you will find the build script <code>build.bat</code>. We will need to edit this build 
  file to point it to the location of your compiler. To do this, simply uncomment 
  the following lines (by removing <code>rem</code>) and modify <code>MSVC_HOME </code>to 
  point to the root directory of your compiler installation.</p>
<blockquote> 
  <pre>rem IF NOT &quot;%MSVC_HOME%&quot;==&quot;&quot; GOTO MAKE
rem set MSVC_HOME=k:\dev\products\msvc60\vc98
rem call %MSVC_HOME%\bin\vcvars32.bat</pre>
</blockquote>
<p>This script has been tested with Microsoft&reg; Visual C/C++ Compiler 6.0 however 
  it is possible that you may need to make additional modifications for your compiler. 
</p>
<p><img src="linux_only.gif" width="51" height="13"> The Linux build script 
  (<code>build.csh)</code> has been tested against GNU C and C++ Compiler. You typically 
  should not need to make any changes to the Linux build script.</p>
<p>&nbsp;</p>
<h3><b>Running the build script</b></h3>
<p>The build script takes two arguments, the filename of the executable file to 
  create (output) and the title (name) of your program. If the program name has spaces 
  in it (as in the example below) you will need to put double-quotes around it. 
</p>
<p>In the example below the program name <i>RCP Browser</i> will be shown 
  in the task bar while the program is starting.</p>
<p><img src="win_only.gif" width="51" height="13"> On Windows you can run the 
  build script (<code>build.bat)</code> as shown below. Prior to running the build script 
  you should run once using the <code>clean</code> target to remove any artifacts from previous builds.  This example will create an executable file named <code>rcp browser.exe</code> with the icon 
  we created above.</p>
<blockquote> 
  <pre>build -output &quot;rcp browser.exe&quot; -name &quot;RCP Browser&quot;</pre>
</blockquote>
<p><img src="linux_only.gif" width="51" height="13"> On Linux you can run the 
  build script (<code>build.csh)</code> as shown below. This example will create an 
  executable file named <i>rcp browser</i>. On Linux an icon is not automatically associated 
  with the executable.</p>
<blockquote> 
  <pre>csh build.csh -output "rcp browser" -name &quot;RCP Browser&quot;</pre>
</blockquote>
<p>&nbsp;</p>

<h3><b>Replacing the existing executable</b> </h3>
<p>Now that you have your own executable, you can copy it to the <code>eclipse/</code> 
  root directory of the browser example. It is a good idea to remove the previous executable so that the user won't be confused on which to run.</p>
<p><img src="linux_only.gif" width="51" height="13"> On Linux we also need to 
  copy the <code>icon.xpm </code>(we created above) to the <code>eclipse/ </code>root replacing 
  the one already found there. </p>
<p>&nbsp;</p>
<p><b><img src="TryIt.gif" width="61" height="13"> </b>Let's give it a whirl! 
  Go to the<code> eclipse/</code> root directory of the browser and start 
  the program by running your executable. Confirm that your executable starts properly, your icons and program name are shown in the appropriate places, 
  and that your splash screen is still shown.</p>
<p>&nbsp;</p>
<h2>Troubleshooting</h2>
<a name="osgi_bundles"/>
<h3><b>Application "..." could not be found in the registry. The applications available are: &lt;NONE&gt;</b></h3>
<p>Use the error log to check that all pre-requisite plug-ins were successfully resolved.  The <code>osgi.bundles</code> property lists the plug-ins that eclipse installs and runs.</p>
<p>Typically only <code>org.eclipse.core.runtime</code> and <code>org.eclipse.update.configurator</code> are listed.  The update configurator will discover and install all plug-ins in the <code>plugins</code> directory.  If you aren't using <code>org.eclipse.update.configurator</code> then list all necessary plug-ins in the <code>osgi.bundles</code> property.</p>
<p>A typical RCP list might look like:</p>
<pre>
osgi.bundles = org.eclipse.core.runtime@2:start, org.eclipse.core.expressions, \
               org.eclipse.help, org.eclipse.jface, org.eclipse.osgi.services, \
               org.eclipse.osgi, org.eclipse.swt, org.eclipse.ui.workbench, \
               org.eclipse.ui, org.eclipse.swt.win32, org.eclipse.swt.gtk, \
               org.eclipse.swt.gtk64, org.eclipse.swt.carbon, \
               org.eclipse.swt.motif
</pre>

<a name="no_app_id"/>
<h3><b>No application id has been found.</b></h3>
<p>This happens when eclipse cannot find the application to run.  This could happen if the product cannot be found or the default application specified in the product extension is not found.  Check for typos in both these ids.</p>

<a name="app_id_typo"/>
<h3><b>Application "..." could not be found in the registry. The applications available are: ...</b></h3>
<p>This is most likely caused by a typo in the application id.  If you are using your product's default application then check the <i>application</i> attribute in the product extension.  Otherwise check the <code>eclipse.application</code> property in the <code>config.ini</code> file.  The value must match the id defined in some application extension.</p>

<a name="product_id_typo"/>
<h3><b>No branding in application</b></h3>
<p>This happens when the product cannot be found check the <code>config.ini</code> file for typos in the value of <code>eclipse.product</code>.</p>

<a name="clean"/>
<h3><b>Changes ignored</b></h3>
<p>If changes to <code>plugin.xml</code> or <code>plugin.properties</code> are not recognized then try running once with the <code>-clean</code> command line option.  This will remove stale cache files to ensure they are regenerated from the newest information.  This option is only required during development when the plugin manifest is changing it will not be needed when your product is deployed.</p>
<p>&nbsp;</p>
<h2>Conclusion</h2>
<p>We have shown how to replace the basic units of branding to make your product look like your own. This included such items as the splash screen, about dialog and the icon and name associated with the launcher.</p>
</p>


<p><small>IBM is a registered trademark of International Business Machines Corporation in the United States, other countries, or both.</small></p>
<p><small>Microsoft, Windows, Windows NT, and the Windows logo are trademarks of Microsoft Corporation in the United States, other countries, or both.</small></p>

</body>
</html>
